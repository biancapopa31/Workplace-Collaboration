

@if (TempData["message"] != null)
{
    <div class="alert @ViewBag.Alert p-3 rounded-3 text-center mb-5">
        @ViewBag.Message
    </div>
}


<body class="bg-light">

    <div class="card mt-3 p-4">
        <div class="row">
            <div class="col-md-12">
                <h3 class="text-center">@Model.Channel.Name</h3>
                <h4 class="text-center">@Model.Category.Name</h4>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div id="chat-messages" class="message-container mb-3">
                    <!-- Display chat messages here -->
                    @foreach (var message in Model.Messages)
                    {
                        <div class="message-bubble border-top p-2">
                            <strong><i class="bi bi-person"></i>@message.User.UserName:</strong> - <samall>@message.SentDate.ToString("hh:mm tt")</samall>
                            <p> @message.Content </p>
                        </div>
                    }
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <form id="messageForm" method="post" action="@Url.Action("Show", "Category", new { channelId = @Model.Channel.Id, categoryId = @Model.Category.Id })">
                    <div class="input-group mb-3">
                        @Html.ValidationSummary(false, "", new { @class = "text-danger" })
                        <input type="hidden" name="ChannelHasCategoryId" value=@Model.Id />
                        <input type="hidden" name="ChannelId" value=@Model.Channel.Id />
                        <input type="hidden" name="CategoryId" value=@Model.Category.Id />


                        <input type="text" class="form-control" placeholder="Type your message..." name="Content"> </input>
                        @Html.ValidationMessage("Content", null, new { @class = "text-danger"})


                        <div class="input-group-append">
                            <button class="btn btn-primary" type="submit">Send</button>
                        </div>
                    </div>
                </form>
               
            </div>
        </div>
    </div>
</body>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var contentInput = document.querySelector('#messageForm input[name="Content"]');

        contentInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                document.getElementById('messageForm').submit();
            }
        });
    });
</script>
